<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>System Initialization</title>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
    :root {
        --cyan: #00f3ff;
        --green: #00ff9d;
        --bg: #050a14;
    }

    body {
        background-color: var(--bg);
        margin: 0; padding: 0;
        height: 100vh; width: 100vw;
        display: flex; flex-direction: column;
        align-items: center; justify-content: center;
        overflow: hidden;
        font-family: 'Share Tech Mono', monospace;
        color: var(--cyan);
        position: relative;
    }

    /* --- BACKGROUND MATRIX EFFECT --- */
    .bg-grid {
        position: absolute; inset: 0;
        background: 
            linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
        background-size: 30px 30px;
        perspective: 500px;
        transform: scale(1.2);
        z-index: 0;
        animation: moveGrid 20s linear infinite;
    }

    /* --- CRT SCANLINE (EFFECT MONITOR LAMA) --- */
    .scanlines {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
        background-size: 100% 4px;
        z-index: 10; pointer-events: none;
    }

    /* --- HUD CIRCLE LOADER --- */
    .hud-container {
        position: relative;
        width: 200px; height: 200px;
        display: flex; justify-content: center; align-items: center;
        margin-bottom: 40px;
        z-index: 2;
    }

    .circle {
        position: absolute; border-radius: 50%; border: 2px solid transparent;
    }
    
    .c1 { width: 100%; height: 100%; border-top: 4px solid var(--cyan); border-bottom: 4px solid var(--cyan); animation: spin 4s linear infinite; box-shadow: 0 0 20px var(--cyan); }
    .c2 { width: 80%; height: 80%; border-left: 2px solid var(--green); border-right: 2px solid var(--green); animation: spinReverse 3s linear infinite; }
    .c3 { width: 60%; height: 60%; border: 1px dashed rgba(255,255,255,0.5); animation: spin 10s linear infinite; }
    
    .center-text { font-family: 'Orbitron'; font-weight: 900; font-size: 24px; color: #fff; animation: pulse 1s infinite alternate; text-shadow: 0 0 10px #fff; }

    /* --- TYPING TEXT --- */
    .msg-box {
        z-index: 2; text-align: center; height: 60px;
    }
    .main-text {
        font-size: 20px; letter-spacing: 3px;
        text-transform: uppercase;
        margin-bottom: 5px;
        text-shadow: 0 0 10px var(--cyan);
    }
    .sub-text {
        font-size: 12px; color: rgba(255,255,255,0.5);
    }

    /* --- PROGRESS BAR --- */
    .progress-wrapper {
        width: 300px; height: 6px;
        background: #111; border: 1px solid #333;
        margin-top: 20px; position: relative; z-index: 2;
        box-shadow: 0 0 15px rgba(0, 243, 255, 0.1);
    }
    .bar {
        height: 100%; width: 0%;
        background: var(--cyan);
        box-shadow: 0 0 20px var(--cyan);
        transition: width 0.3s ease-out;
        position: relative;
    }
    .bar::after {
        content: ''; position: absolute; top: 0; right: 0; width: 5px; height: 100%;
        background: #fff; box-shadow: 0 0 10px #fff;
    }

    /* --- GLITCH EFFECT --- */
    .glitch { animation: glitchAnim 0.3s infinite; color: var(--green) !important; text-shadow: 2px 0 red, -2px 0 blue; }

    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    @keyframes spinReverse { 0% { transform: rotate(360deg); } 100% { transform: rotate(0deg); } }
    @keyframes pulse { 0% { opacity: 0.5; } 100% { opacity: 1; } }
    @keyframes moveGrid { 0% { transform: scale(1.5) translateY(0); } 100% { transform: scale(1.5) translateY(50px); } }
    @keyframes glitchAnim {
        0% { transform: translate(0); }
        20% { transform: translate(-2px, 2px); }
        40% { transform: translate(-2px, -2px); }
        60% { transform: translate(2px, 2px); }
        80% { transform: translate(2px, -2px); }
        100% { transform: translate(0); }
    }

</style>
</head>
<body>

    <div class="scanlines"></div>
    <div class="bg-grid"></div>

    <div class="hud-container">
        <div class="circle c1"></div>
        <div class="circle c2"></div>
        <div class="circle c3"></div>
        <div class="center-text" id="percent">0%</div>
    </div>

    <div class="msg-box">
        <div class="main-text" id="statusMsg">INITIALIZING...</div>
        <div class="sub-text" id="detailMsg">CONNECTING TO YPKT SECURE SERVER</div>
    </div>

    <div class="progress-wrapper">
        <div class="bar" id="progressBar"></div>
    </div>

    <div style="position: absolute; bottom: 10px; font-size: 10px; color: #444; z-index: 2;">
        SECURE CONNECTION // ENCRYPTED: AES-256
    </div>

<script>
    // --- FIREBASE CONFIG ---
    const firebaseConfig = {
      apiKey:"AIzaSyDjsNiteoay79tpavm_dfCcKHhRvBfU0Tk",
      authDomain:"e-complaint-8nu9kp.firebaseapp.com",
      projectId:"e-complaint-8nu9kp"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // --- ANIMATION SEQUENCE ---
    auth.onAuthStateChanged((user) => {
        if (user) {
            startSequence(user.email);
        } else {
            window.location.replace("login.html");
        }
    });

    function startSequence(email) {
        const bar = document.getElementById("progressBar");
        const status = document.getElementById("statusMsg");
        const detail = document.getElementById("detailMsg");
        const percent = document.getElementById("percent");

        let width = 0;
        
        // Function update progress manual supaya nampak real
        const interval = setInterval(() => {
            width += Math.floor(Math.random() * 5) + 1; // Naik random
            if(width > 100) width = 100;

            bar.style.width = width + "%";
            percent.innerText = width + "%";

            // TUKAR TEKS BERDASARKAN PERATUS
            if(width > 20 && width < 50) {
                status.innerText = "AUTHENTICATING";
                detail.innerText = "VERIFYING USER ID: " + email;
            }
            if(width > 50 && width < 80) {
                status.innerText = "LOADING MODULES";
                detail.innerText = "RETRIEVING ENCRYPTED ASSETS...";
                status.classList.remove("glitch"); // Hilangkan glitch sekejap
            }
            if(width > 80) {
                status.innerText = "ACCESS GRANTED";
                status.style.color = "#00ff9d";
                status.classList.add("glitch"); // Tambah glitch effect bila berjaya
                detail.innerText = "WELCOME, ADMIN.";
                document.querySelector('.c1').style.borderColor = "#00ff9d";
                document.querySelector('.c1').style.boxShadow = "0 0 20px #00ff9d";
                bar.style.background = "#00ff9d";
                bar.style.boxShadow = "0 0 20px #00ff9d";
            }

            if(width === 100) {
                clearInterval(interval);
                setTimeout(() => {
                    window.location.replace("dashboard.html");
                }, 800);
            }

        }, 50); // Speed loading
    }
</script>

</body>
</html>
